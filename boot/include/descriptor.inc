;https://wiki.osdev.org/Global_Descriptor_Table

;----------------------------------------------------------------------------
DESC_DB_32BITS	EQU   	0_1_00000000000000b
DESC_G_4K_LIMIT	EQU	   	1__000000000000000b

DESC_DPL0		EQU	  	000000000_00_00000b
DESC_DPL1		EQU	  	000000000_01_00000b
DESC_DPL2		EQU	  	000000000_10_00000b
DESC_DPL3		EQU		000000000_11_00000b
;----------------------------------------------------------------------------
DESC_DR			EQU		000000000000_0000_b
DESC_DRW		EQU		000000000000_0010_b
DESC_DRWA		EQU		000000000000_0011_b
DESC_C			EQU		000000000000_1000_b
DESC_CR			EQU		000000000000_1010_b
DESC_CCO		EQU		000000000000_1100_b
DESC_CCOR		EQU		000000000000_1110_b
;----------------------------------------------------------------------------
DESC_LDT		EQU	  	000000000000_0010_b
DESC_TaskGate	EQU	  	000000000000_0101_b
DESC_386TSS		EQU	  	000000000000_1001_b
DESC_386CGate	EQU	  	000000000000_1100_b
DESC_386IGate	EQU	  	000000000000_1110_b
DESC_386TGate	EQU		000000000000_1111_b
;----------------------------------------------------------------------------
DESC_P			EQU 	00000000_1_0000000b
DESC_S_C_D		EQU     00000000000_1_0000b
DESC_S_SYS		EQU     00000000000_0_0000b
;----------------------------------------------------------------------------
RPL0			EQU	0
RPL1			EQU	1
RPL2			EQU	2
RPL3			EQU	3
TI_GDT			EQU	0
TI_LDT			EQU	4
;----------------------------------------------------------------------------
PAGE_P			EQU	1b
PAGE_R			EQU	0
PAGE_RW			EQU	10b
PAGE_S			EQU	0
PAGE_U			EQU	100b
;----------------------------------------------------------------------------
%macro Descriptor 3
	dw	%2 & 0FFFFh
	dw	%1 & 0FFFFh
	db	(%1 >> 16) & 0FFh
	dw	((%2 >> 8) & 0F00h) | (%3 & 0F0FFh)
	db	(%1 >> 24) & 0FFh
%endmacro

%macro Gate 4
	dw	(%2 & 0FFFFh)
	dw	%1
	dw	(%3 & 1Fh) | ((%4 << 8) & 0FF00h)
	dw	((%2 >> 16) & 0FFFFh)
%endmacro